({647:function(){var t=this&&this.__assign||function(){return t=Object.assign||function(t){for(var e,n=1,a=arguments.length;n<a;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},t.apply(this,arguments)},e=this&&this.__awaiter||function(t,e,n,a){return new(n||(n=Promise))(function(i,r){function l(t){try{o(a.next(t))}catch(t){r(t)}}function s(t){try{o(a.throw(t))}catch(t){r(t)}}function o(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n(function(t){t(e)})).then(l,s)}o((a=a.apply(t,e||[])).next())})},n=this&&this.__generator||function(t,e){var n,a,i,r={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]},l=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return l.next=s(0),l.throw=s(1),l.return=s(2),"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function s(s){return function(o){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;l&&(l=0,s[0]&&(r=0)),r;)try{if(n=1,a&&(i=2&s[0]?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return r.label++,{value:s[1],done:!1};case 5:r.label++,a=s[1],s=[0];continue;case 7:s=r.ops.pop(),r.trys.pop();continue;default:if(!((i=(i=r.trys).length>0&&i[i.length-1])||6!==s[0]&&2!==s[0])){r=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){r.label=s[1];break}if(6===s[0]&&r.label<i[1]){r.label=i[1],i=s;break}if(i&&r.label<i[2]){r.label=i[2],r.ops.push(s);break}i[2]&&r.ops.pop(),r.trys.pop();continue}s=e.call(t,r)}catch(t){s=[6,t],a=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,o])}}},a={Acrobatics:"DEX","Animal Handling":"WIS",Arcana:"INT",Athletics:"STR",Deception:"CHA",History:"INT",Insight:"WIS",Intimidation:"CHA",Investigation:"INT",Medicine:"WIS",Nature:"INT",Perception:"WIS",Performance:"CHA",Persuasion:"CHA",Religion:"INT","Sleight of Hand":"DEX",Stealth:"DEX",Survival:"WIS"},i=["STR","DEX","CON","INT","WIS","CHA"],r=Object.keys(a);function l(){var t;try{var e=null!==(t=globalThis.webviewApi)&&void 0!==t?t:window.webviewApi;if(e&&"function"==typeof e.postMessage&&"function"==typeof e.onMessage)return e}catch(t){}return null}function s(){return e(this,arguments,void 0,function(t){var e,a;return void 0===t&&(t=1200),n(this,function(n){switch(n.label){case 0:e=Date.now(),n.label=1;case 1:return(a=l())?[2,a]:Date.now()-e>t?[2,null]:[4,new Promise(function(t){return setTimeout(t,50)})];case 2:n.sent(),n.label=3;case 3:return[3,1];case 4:return[2]}})})}var o=function(t,e,n){return Math.max(e,Math.min(n,t))};function c(t){var e,n=i.reduce(function(e,n){return e[n]=(a=t.abilities[n],Math.floor((a-10)/2)),e;var a},{}),l=(e=t.level||1)>=17?6:e>=13?5:e>=9?4:e>=5?3:2,s=i.reduce(function(e,a){var i,r=n[a],s=(null===(i=t.savingThrowsProficiencies)||void 0===i?void 0:i[a])?l:0;return e[a]=r+s,e},{}),o=r.reduce(function(e,i){var r,s=n[a[i]],o=(null===(r=t.skillsProficiencies)||void 0===r?void 0:r[i])||"none",c="prof"===o?l:"expert"===o?2*l:0;return e[i]=s+c,e},{}),c=10+o.Perception,d=n.DEX;return{mods:n,proficiencyBonus:l,skills:o,savingThrows:s,passivePerception:c,initiative:d}}function d(t){if(t=t.trim(),/^\s*([+\-]?\d+)\s*$/.test(t)){var e=parseInt(t,10);return{total:e,detail:"".concat(e)}}var n=/^\s*(?:(-?\d*)\s*)?d\s*(\d+)\s*([+\-]\s*\d+)?\s*$/i.exec(t);if(!n)return{total:NaN,detail:"Invalid roll"};for(var a=n[1],i=n[2],r=n[3],l=a?parseInt(a,10):1,s=parseInt(i,10),o=r?parseInt(r.replace(/\s+/g,""),10):0,c=Math.max(1,Math.abs(l)),d=[],u=0;u<c;u++)d.push(1+Math.floor(Math.random()*s));var p=d.reduce(function(t,e){return t+e},0),v=(p=l<0?-p:p)+o,f=o>=0?"+".concat(o):"".concat(o);return{total:v,detail:"".concat(l,"d").concat(s).concat(o?f:""," = [").concat(d.join(", "),"] ").concat(l<0?"=> negate ":"").concat(p).concat(o?" ".concat(f," = ").concat(v):"")}}function u(){return{name:"",class:"",level:1,race:"",background:"",alignment:"",abilities:{STR:10,DEX:10,CON:10,INT:10,WIS:10,CHA:10},armorClass:10,maxHP:1,currentHP:1,tempHP:0,speed:"30 ft",savingThrowsProficiencies:{},skillsProficiencies:r.reduce(function(t,e){return t[e]="none",t},{}),attacks:[],notes:""}}var p=null;function v(t){return"dnd.character.editor.v1:"+(t||"unknown")}var f=null,g=u(),m=c(g),h=null;function b(t,e){void 0===e&&(e=1600);var n=document.getElementById("status");n&&(n.textContent=t),h&&window.clearTimeout(h),h=window.setTimeout(function(){n&&n.textContent===t&&(n.textContent="")},e)}function x(e){g=t(t({},g),e),m=c(g),T()}function k(t,e){for(var n,a=t.split("."),i=a.pop(),r=g,l=0,s=a;l<s.length;l++){var o=s[l];r[o]=null!==(n=r[o])&&void 0!==n?n:{},r=r[o]}r[i]=e,m=c(g),T()}function y(t,e,n){void 0===e&&(e={}),void 0===n&&(n=[]);for(var a=document.createElement(t),i=0,r=Object.entries(e);i<r.length;i++){var l=r[i],s=l[0],o=l[1];"class"===s?a.className=o:"style"===s&&"object"==typeof o?Object.assign(a.style,o):s.startsWith("data-")?a.setAttribute(s,String(o)):"for"===s?a.setAttribute("for",String(o)):"value"===s?a.value=o:s in a?a[s]=o:a.setAttribute(s,String(o))}for(var c=0,d=n;c<d.length;c++){var u=d[c];a.appendChild("string"==typeof u?document.createTextNode(u):u)}return a}function w(t,e,n,a,i){void 0===i&&(i="text");var r=y("input",{id:e,type:i,value:n,class:"inp"});return r.addEventListener("input",function(){return a(r.value)}),y("label",{class:"lbl"},[y("div",{class:"lblt"},[t]),r])}function C(t,e,n,a,i,r){var l=y("input",{id:e,type:"number",value:n,class:"inp"});return void 0!==i&&l.setAttribute("min",String(i)),void 0!==r&&l.setAttribute("max",String(r)),l.addEventListener("input",function(){return a(function(t,e){void 0===e&&(e=0);var n=parseInt(String(t),10);return Number.isFinite(n)?n:e}(l.value,n))}),y("label",{class:"lbl"},[y("div",{class:"lblt"},[t]),l])}function E(){var t=document.getElementById("root");if(t){var e=document.createElement("style");e.textContent="\n    :root { --bd:#d0d4db; --tx:#101216; --mut:#5a6270; --bg:#ffffff; --chip:#f5f7fa; }\n    * { box-sizing: border-box; }\n    body { margin:0; background: var(--bg); color: var(--tx); font: 14px/1.35 system-ui, -apple-system, Segoe UI, Roboto, sans-serif; }\n    .wrap { padding: 12px; }\n    h2 { margin: 16px 0 8px; font-size: 16px; }\n    .grid2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; }\n    .grid3 { display: grid; grid-template-columns: repeat(3,1fr); gap: 8px; }\n    .cols { display: grid; grid-template-columns: 320px 1fr; gap: 16px; align-items: start; }\n    .card { border: 1px solid var(--bd); border-radius: 10px; padding: 10px; background: #fff; }\n    .lbl { display:block; }\n    .lblt { font-size: 11px; color: var(--mut); margin-bottom: 4px; }\n    .inp, .sel, textarea { width: 100%; padding: 8px; border: 1px solid var(--bd); border-radius: 8px; background: #fff; }\n    textarea { min-height: 80px; resize: vertical; }\n    .row { display:flex; gap:8px; align-items:center; }\n    .mut { color: var(--mut); }\n    .chip { background: var(--chip); border:1px solid var(--bd); padding:6px 8px; border-radius: 8px; }\n    .skills { display: grid; grid-template-columns: 1fr auto auto; gap: 6px 8px; align-items: center; }\n    .skillHead { font-size: 12px; color:var(--mut); display: contents; }\n    .btn { border:1px solid var(--bd); background:#fff; padding:8px 10px; border-radius: 8px; cursor:pointer; }\n    .btn:hover { background:#f9fafb; }\n    .btn.small { padding:4px 6px; font-size:12px; }\n    .right { text-align: right; }\n    .status { margin-left: 8px; color: var(--mut); }\n    .attacks .hdr, .attacks .row {\n        display: grid;\n        grid-template-columns: 1.2fr 100px 100px 1fr 1fr max-content; /* Attack | Range | Hit/DC | Damage | Notes | âœ• */\n        gap: 6px;\n        align-items: center;\n    }\n    .attacks .hdr { color: var(--mut); font-size:12px; }\n    .attack-roll-btn { white-space: nowrap; }\n\n    /* Top bar (left: roll/load/save, right: tabs) */\n    .topbar {\n      position: sticky; top: 0; z-index: 10;\n      display: flex; justify-content: space-between; align-items: center;\n      margin-bottom: 8px; padding-top: 8px; background: var(--bg);\n    }\n    .topbar .leftActions, .topbar .rightActions {\n      display: flex; align-items: center; gap: 8px;\n    }\n    .tab.btn {} /* inherits .btn */\n    .tab.btn.active { box-shadow: 0 1px 4px rgba(0,0,0,0.08); }\n\n    /* Right column container (avoid global .right{text-align:right}) */\n    .rightCol { display: flex; flex-direction: column; min-width: 420px; }\n    .rightPanel { display: flex; flex-direction: column; gap: 16px; }\n\n    /* Keep skill prof selects compact and stable */\n    .skills select, .skills .sel {\n      width: 88px !important; min-width: 88px !important; max-width: 88px !important;\n      flex: 0 0 88px; justify-self: start;\n    }\n    .skills { grid-template-columns: 1fr max-content max-content; }\n\n    /* Saving throws compactness */\n    .saving-throws-grid .row { gap: 6px; }\n    .saving-throws-grid .mut { white-space: nowrap; }\n\n    /* Optional: tighten first card header spacing */\n    .left .card:first-child h2, .rightCol .card:first-child h2 { margin-top: 0; }\n  ",e.textContent+="\n  /* Attacks table: header + rows share the same columns */\n  .attacks .header,\n  .attacks .rowGrid {\n    display: grid;\n    grid-template-columns: 1.2fr 100px 100px 1fr 1fr max-content; /* Attack | Range | Hit/DC | Damage | Notes | âœ• */\n    gap: 6px;\n    align-items: center;\n  }\n  .attacks .header {\n    color: var(--mut);\n    font-size: 12px;\n    margin-bottom: 6px;\n  }\n\n  /* Input+button inline for Hit/DC and Damage cells */\n  .attacks .cell-inline { display: flex; align-items: center; gap: 6px; }\n\n  /* Smaller dice buttons */\n  .attack-roll-btn {\n    padding: 2px 6px;\n    font-size: 12px;\n    line-height: 1;\n    border-radius: 6px;\n  }\n",e.textContent+="\n  /* Skills container should NOT be a grid */\n  .skillsTable { display: block; }\n\n  /* Header and each row share the same 3-column grid */\n  .skillsHeader,\n  .skillRow {\n    display: grid;\n    grid-template-columns: 1fr max-content max-content; /* Skill | Total | Prof */\n    gap: 6px 8px;\n    align-items: center;\n  }\n\n  .skillsHeader {\n    color: var(--mut);\n    font-size: 12px;\n    margin-bottom: 6px;\n  }\n\n  .skillRow .right { text-align: right; }\n\n  .skillTotalWrap {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    justify-content: flex-end;\n  }\n\n  /* Keep the small dropdowns compact */\n  .skillsTable select,\n  .skillsTable .sel {\n    width: 88px !important; min-width: 88px !important; max-width: 88px !important;\n    flex: 0 0 88px; justify-self: start;\n  }\n",document.head.appendChild(e);var n=y("div",{class:"left"}),l=y("div",{class:"rightCol"}),s=y("div",{class:"card"},[y("h2",{},["Identity"]),w("Name","name",g.name,function(t){return x({name:t})}),y("div",{class:"grid2"},[w("Class","class",g.class,function(t){return x({class:t})}),C("Level","level",g.level,function(t){return x({level:o(t,1,20)})},1,20)]),y("div",{class:"grid3"},[w("Race","race",g.race||"",function(t){return x({race:t})}),w("Background","background",g.background||"",function(t){return x({background:t})}),w("Alignment","alignment",g.alignment||"",function(t){return x({alignment:t})})])]),u=y("div",{class:"card"});u.appendChild(y("h2",{},["Abilities"]));var p=y("div",{class:"grid3"});i.forEach(function(t){var e=C(`${t} (mod ${A(m.mods[t])})`,`abil.${t}`,g.abilities[t],function(e){return k(`abilities.${t}`,o(e,1,30))},1,30);e.setAttribute("data-ability",t),p.appendChild(e)}),u.appendChild(p);var v=y("div",{class:"card"});v.appendChild(y("h2",{},["Saving Throws"]));var h=y("div",{class:"grid3 saving-throws-grid"});i.forEach(function(t){var e=y("div",{class:"row chip"},[y("input",{type:"checkbox",checked:!!g.savingThrowsProficiencies[t]}),y("div",{},[`${t} save`]),y("div",{class:"mut"},[y("span",{id:`save.total.${t}`},[A(m.savingThrows[t])])])]);e.firstChild.addEventListener("change",function(e){var n=e.target.checked;k(`savingThrowsProficiencies.${t}`,n)}),h.appendChild(e)}),v.appendChild(h);var E=y("div",{class:"card"},[y("h2",{},["Combat"]),y("div",{class:"grid3"},[C("Armor Class","ac",g.armorClass,function(t){return x({armorClass:o(t,0,40)})},0,40),C("HP (max)","hp.max",g.maxHP,function(t){return x({maxHP:Math.max(1,t)})},1),C("HP (current)","hp.cur",g.currentHP,function(t){return x({currentHP:o(t,0,g.maxHP)})},0)]),y("div",{class:"grid3",style:{marginTop:"6px"}},[w("Speed","speed",g.speed||"",function(t){return x({speed:t})}),C("Temp HP","hp.temp",g.tempHP||0,function(t){return x({tempHP:Math.max(0,t)})},0),y("label",{class:"lbl"},[y("div",{class:"lblt"},["Initiative"]),y("div",{class:"chip"},[y("span",{id:"derived.initiative"},[A(m.initiative)])," (DEX mod)"])])]),y("div",{class:"row",style:{marginTop:"6px"}},[y("div",{class:"chip"},["Prof bonus: ",y("strong",{id:"derived.pb"},[A(m.proficiencyBonus)])]),y("div",{class:"chip"},["Passive Perception: ",y("strong",{id:"derived.pp"},[String(m.passivePerception)])])])]);n.appendChild(s),n.appendChild(u),n.appendChild(v),n.appendChild(E);var S=y("div",{class:"card"});S.appendChild(y("h2",{},["Skills"]));var H=y("div",{class:"skillsTable"}),P=y("div",{class:"skillsHeader"},[y("div",{},["Skill"]),y("div",{class:"right"},["Total"]),y("div",{},["Prof"])]);H.appendChild(P),r.forEach(function(t){var e=y("div",{},[`${t} `,y("span",{class:"mut"},[`(${a[t]})`])]),n=y("div",{id:`skill.total.${t}`,class:"right"},[A(m.skills[t])]),i=y("button",{class:"btn small",title:"Roll skill"},["ðŸŽ²"]),r=y("div",{class:"skillTotalWrap"},[n,i]);i.addEventListener("click",function(){var e,n=`1d20${e=m.skills[t],e>=0?"+".concat(e):"".concat(e)}`;if(f)f.postMessage({type:"roll",expr:n});else{var a=d(n);b(`Roll ${t}: ${a.total} (${a.detail})`,4e3)}});var l=function(e){var n=y("select",{class:"sel"},[y("option",{value:"none",selected:"none"===e},["â€”"]),y("option",{value:"prof",selected:"prof"===e},["â—"]),y("option",{value:"expert",selected:"expert"===e},["â—Ž"])]);return n.addEventListener("change",function(){return e=n.value,k(`skillsProficiencies.${t}`,e);var e}),n}(g.skillsProficiencies[t]||"none"),s=y("div",{class:"skillRow"},[e,r,l]);H.appendChild(s)}),S.appendChild(H);var $=y("div",{class:"card attacks"});$.appendChild(y("h2",{},["Attacks"]));var L=y("div",{id:"attacks.list"}),N=y("button",{class:"btn",style:{marginTop:"8px"}},["+ Add attack"]);N.addEventListener("click",function(){g.attacks.push({name:"New Attack",range:"Melee",hitDc:"+0",damage:"1d6+2",notes:""}),m=c(g),I()}),$.appendChild(L),$.appendChild(N);var D,M=y("div",{class:"card"},[y("h2",{},["Notes"]),(D=y("textarea",{value:g.notes||""}),D.addEventListener("input",function(){return x({notes:D.value})}),D)]);S.setAttribute("data-panel","skills"),$.setAttribute("data-panel","attacks"),M.setAttribute("data-panel","notes");var R=y("div",{class:"rightPanel"});R.appendChild(S),R.appendChild($),R.appendChild(M),l.innerHTML="",l.appendChild(R);var j=y("div",{class:"leftActions"},[y("button",{class:"btn",id:"btn.roll"},["Roll d20"]),y("button",{class:"btn",id:"btn.load"},["Load"]),y("button",{class:"btn",id:"btn.save"},["Save"]),y("div",{id:"status",class:"status"},[""])]),O=y("div",{class:"rightActions"},[y("button",{class:"btn tab active","data-target":"skills"},["Skills"]),y("button",{class:"btn tab","data-target":"attacks"},["Attacks"]),y("button",{class:"btn tab","data-target":"notes"},["Notes"])]),B=y("div",{class:"topbar"},[j,O]);t.innerHTML="";var W=y("div",{class:"wrap"});W.appendChild(B);var z=y("div",{class:"cols"},[n,l]);W.appendChild(z),t.appendChild(W),O.addEventListener("click",function(t){var e=t.target.closest(".tab");e&&X(e.getAttribute("data-target"))}),X("skills"),document.getElementById("btn.roll").addEventListener("click",function(){if(f)f.postMessage({type:"roll",expr:"1d20"});else{var t=d("1d20");b(`Roll d20: ${t.total} (${t.detail})`,3e3)}}),document.getElementById("btn.save").addEventListener("click",function(){f?f.postMessage({type:"save",character:g}):(function(t){try{localStorage.setItem("dnd.character.editor.v1",JSON.stringify(t))}catch(t){}}(g),b("Saved locally âœ“"))}),document.getElementById("btn.load").addEventListener("click",function(){f?(f.postMessage({type:"load"}),b("Loadingâ€¦")):b("Nothing to load (offline)")}),I(),T()}function X(t){Array.from(O.querySelectorAll(".tab")).forEach(e=>e.classList.toggle("active",e.getAttribute("data-target")===t)),Array.from(R.children).forEach(e=>e.style.display=e.getAttribute("data-panel")===t?"":"none")}}function S(t,e){return y("label",{class:"lbl"},[y("div",{class:"lblt"},[t]),e])}function I(){var t=document.getElementById("attacks.list");t&&(t.innerHTML="",g.attacks.forEach(function(e,n){var a=null!=e.hitDc?String(e.hitDc):null!=e.toHit?String(e.toHit):"+0",i=null!=e.damage?String(e.damage):"1d4",r=null!=e.range?String(e.range):"",l=y("input",{class:"inp",value:e.name||""}),s=y("input",{class:"inp",value:r}),o=y("input",{class:"inp",value:a,title:"Enter modifier (e.g. +5). Double-click/Enter or ðŸŽ² to roll"}),c=y("button",{class:"btn attack-roll-btn",title:"Roll Hit/DC"},["ðŸŽ²"]),u=y("div",{class:"cell-inline"},[o,c]),p=y("input",{class:"inp",value:i,title:"Composite damage like 2d6+1d4+3"}),v=y("button",{class:"btn attack-roll-btn",title:"Roll Damage"},["ðŸŽ²"]),m=y("div",{class:"cell-inline"},[p,v]),h=y("input",{class:"inp",value:e.notes||""}),x=y("button",{class:"btn small",title:"Remove"},["âœ•"]);function k(){var t=parseInt(String(o.value).replace(/\s+/g,""),10);Number.isFinite(t)||(t=0);var n=`1d20${t>=0?"+"+t:t}`;if(f)f.postMessage({type:"roll",expr:n});else{var a=d(n);b(`Hit/DC (${e.name||"Attack"}): ${a.total} (${a.detail})`,4e3)}}function w(){var t=function(t){var e=String(t||"0").replace(/\s+/g,"");e||(e="0");for(var n,a=e.replace(/^\+/,""),i=/^[+\-]/.test(e)?e:"+"+e,r=[],l=/([+\-])(\d*d\d+|\d+)/gi;null!==(n=l.exec(i));)r.push({sign:"-"===n[1]?-1:1,term:n[2]});var s=0,o=[];r.forEach(function(t){var e=t.term.toLowerCase();if(e.includes("d")){var n=/^(\d*)d(\d+)$/.exec(e);if(!n)return;var a=n[1]?parseInt(n[1],10):1,i=parseInt(n[2],10);a=Math.max(1,a);for(var r=[],l=0;l<a;l++)r.push(1+Math.floor(Math.random()*i));var c=r.reduce((t,e)=>t+e,0)*t.sign;s+=c,o.push(`${t.sign<0?"-":"+"}${a}d${i}[${r.join(",")}]${t.sign<0?"(neg)":""}`)}else{var d=parseInt(e,10);Number.isFinite(d)||(d=0),d*=t.sign,s+=d,o.push(`${t.sign<0?"-":"+"}${Math.abs(d)}`)}});var c=o.join(" ").replace(/^\+/,""),d=i,u=null;return/^\+?\d*d\d+(?:[+\-]\d+)?$/i.test(d)&&(u=d.replace(/^\+/,"")),{total:s,detail:c,expr:d,exprForHost:u,raw:a}}(String(p.value||"0"));f&&t.exprForHost?f.postMessage({type:"roll",expr:t.exprForHost}):b(`Damage (${e.name||"Attack"}): ${t.total} (${t.detail})`,4e3)}l.addEventListener("input",function(){g.attacks[n].name=l.value}),s.addEventListener("input",function(){g.attacks[n].range=s.value}),o.addEventListener("input",function(){g.attacks[n].hitDc=o.value,g.attacks[n].toHit=o.value}),p.addEventListener("input",function(){g.attacks[n].damage=p.value}),h.addEventListener("input",function(){g.attacks[n].notes=h.value}),x.addEventListener("click",function(){g.attacks.splice(n,1),I()}),c.addEventListener("click",k),v.addEventListener("click",w),o.addEventListener("keydown",function(t){"Enter"===t.key&&k()}),o.addEventListener("dblclick",k),p.addEventListener("keydown",function(t){"Enter"===t.key&&w()}),p.addEventListener("dblclick",w);var C=y("div",{class:"rowGrid"},[S("Attack",l),S("Range",s),S("Hit/DC",u),S("Damage",m),S("Notes",h),x]);t.appendChild(C)}))}function T(){i.forEach(function(t){var e=document.querySelector('[data-ability="'.concat(t,'"] .lblt'));e&&(e.textContent="".concat(t," (mod ").concat(A(m.mods[t]),")"))});var t=document.getElementById("derived.pb");t&&(t.textContent=A(m.proficiencyBonus));var e=document.getElementById("derived.pp");e&&(e.textContent=String(m.passivePerception));var n=document.getElementById("derived.initiative");n&&(n.textContent=A(m.initiative)),i.forEach(function(t){var e=document.getElementById("save.total.".concat(t));e&&(e.textContent=A(m.savingThrows[t]))}),r.forEach(function(t){var e=document.getElementById("skill.total.".concat(t));e&&(e.textContent=A(m.skills[t]))})}function A(t){return t>=0?"+".concat(t):"".concat(t)}function H(e,n){var a,i,l,s=function(t){var e,n,a,i,r,l;return{STR:null!==(e=null==t?void 0:t.STR)&&void 0!==e?e:10,DEX:null!==(n=null==t?void 0:t.DEX)&&void 0!==n?n:10,CON:null!==(a=null==t?void 0:t.CON)&&void 0!==a?a:10,INT:null!==(i=null==t?void 0:t.INT)&&void 0!==i?i:10,WIS:null!==(r=null==t?void 0:t.WIS)&&void 0!==r?r:10,CHA:null!==(l=null==t?void 0:t.CHA)&&void 0!==l?l:10}}(t(t({},e.abilities),null!==(a=n.abilities)&&void 0!==a?a:{})),o=function(t){for(var e,n={},a=0,i=r;a<i.length;a++){var l=i[a];n[l]=null!==(e=null==t?void 0:t[l])&&void 0!==e?e:"none"}return n}(t(t({},null!==(i=e.skillsProficiencies)&&void 0!==i?i:{}),null!==(l=n.skillsProficiencies)&&void 0!==l?l:{}));return t(t(t({},e),n),{abilities:s,savingThrowsProficiencies:t(t({},e.savingThrowsProficiencies||{}),n.savingThrowsProficiencies||{}),skillsProficiencies:o,attacks:(n.attacks||e.attacks||[]).map(function(e){return t({name:"",toHit:"",damage:"",notes:""},e)})})}!function(){function t(){try{!function(){e(this,void 0,void 0,function(){var t;return n(this,function(e){switch(e.label){case 0:return document.getElementById("root")||((t=document.createElement("div")).id="root",document.body.appendChild(t)),E(),[4,s(1500)];case 1:if(f=e.sent())f.onMessage(function(t){const e=t&&"object"==typeof t?"message"in t&&"object"==typeof t.message?t.message:"data"in t&&"object"==typeof t.data?t.data:t:t;console.log("[webview] message (unwrapped):",e," raw:",t),e&&"object"==typeof e&&("data"===e.type?(p=e.noteId||p,g=H(u(),e.character||{}),m=c(g),p&&function(t,e){if(t)try{localStorage.setItem(v(t),JSON.stringify(e))}catch{}}(p,g),E(),b("Loaded âœ“")):"saved"===e.type?b("Saved âœ“"):"error"===e.type?b(`Error: ${e.message}`,4e3):"rollResult"===e.type&&b(`Roll: ${e.result}`,4e3))}),f.postMessage({type:"load"});else{const t=p?function(t){if(!t)return null;try{const e=localStorage.getItem(v(t));return e?JSON.parse(e):null}catch{return null}}(p):null;t?(g=H(u(),t),m=c(g),E(),b("Loaded (local cache)")):b("Offline mode â€” using defaults")}return[2]}})})}();const t=l();t&&(f=t).postMessage({type:"ready"})}catch(t){console.error("[renderer] bootstrap error:",t)}}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",t,{once:!0}):t()}()}})[647](),exports.default={}.default;